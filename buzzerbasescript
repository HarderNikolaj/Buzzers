create database buzzerbase;

create table usertype(
	id int identity primary key,
	typename nvarchar (50) not null unique
);

create table user(
	id int identity primary key,
	usertypeid int foreign key references usertype(id),
	firstname nvarchar (50) not null,
	lastname nvarchar (50) not null,
	email nvarchar (100) not null unique,
	birthdate date not null,
	bio nvarchar (1000),
	jobtitle nvarchar (50)
);

create table userlogin(
	id int identity primary key,
	userid int foreign key references user(id),
	pass nvarchar (30) not null
);

create table gender(
	id int identity primary key,
	gender nvarchar (6) not null unique
);

create table personaldetails(
	id int identity primary key,
	userid foreign key references user(id),
	haircolor nvarchar (25),
	eyecolor nvarchar (25),
	height int,
	weight int,
	genderid foreign key references gender(id)
);

create table buzz(
	id int identity primary key,
	buzzerid int foreign key references user(id),
	buzzeeid int foreign key references user(id),
	timestamp datetime not null default(getdate())
);
	
create table match(
	id int identity primary key,
	firstbuzzerid int foreign key references user(id),
	lastbuzzerid int foreign key references user(id),
	timestamp datetime not null default(getdate())
);
	
create table message(
	id int identity primary key,
	senderid int foreign key references user(id),
	recieverid int foreign key references user(id),
	timestamp datetime not null default(getdate()),
	text nvarchar (500) not null
);

create table image(
	id int identity primary key,
	userid int foreign key references user(id),
	imagename nvarchar(255) not null,
	constraint useridimagenameconst unique(userid, imagename)
);